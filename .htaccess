# .htaccess - Burger House 2025
# Arquivo de configuração Apache

<IfModule mod_rewrite.c>
    # Ativar reescrita de URLs
    RewriteEngine On
    
    # Base do projeto
    RewriteBase /2025-TCC/
    
    # Permitir acesso direto a arquivos estáticos existentes
    RewriteCond %{REQUEST_FILENAME} -f [OR]
    RewriteCond %{REQUEST_FILENAME} -d
    RewriteRule ^(assets|uploads|css|js|images|fonts)/.*$ - [L]
    
    # Bloquear acesso direto às pastas sensíveis
    RewriteRule ^(config|includes|logs)/.*$ - [F,L]
    
    # Permitir acesso a arquivos PHP específicos em public
    RewriteCond %{REQUEST_FILENAME} -f
    RewriteCond %{REQUEST_URI} \.php$
    RewriteRule ^public/.*\.php$ - [L]
    
    # Redirecionar todas as outras requisições para index.php
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ index.php?url=$1 [QSA,L]
</IfModule>

# Página de erro personalizada
ErrorDocument 404 /2025-TCC/index.php

# Segurança - Bloquear acesso a arquivos sensíveis
<FilesMatch "\.(htaccess|htpasswd|ini|log|sh|sql|md|env|git|gitignore)$">
    Require all denied
</FilesMatch>

# Proteção contra listagem de diretórios
Options -Indexes +FollowSymLinks

# Configurações de segurança de headers
<IfModule mod_headers.c>
    # Prevenir clickjacking
    Header always set X-Frame-Options "SAMEORIGIN"
    
    # Prevenir MIME sniffing
    Header always set X-Content-Type-Options "nosniff"
    
    # XSS Protection
    Header always set X-XSS-Protection "1; mode=block"
    
    # Referrer Policy
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
</IfModule>

# Configurações PHP
<IfModule mod_php.c>
    php_value upload_max_filesize 10M
    php_value post_max_size 10M
    php_value max_execution_time 300
    php_value max_input_time 300
    php_value memory_limit 256M
    php_flag display_errors On
    php_flag log_errors On
</IfModule>

# Força UTF-8
AddDefaultCharset UTF-8

# Compressão GZIP para melhor performance
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript application/json
</IfModule>

# Cache de arquivos estáticos
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType image/jpg "access plus 1 year"
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType image/webp "access plus 1 year"
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
    ExpiresByType application/pdf "access plus 1 month"
    ExpiresByType image/x-icon "access plus 1 year"
</IfModule>

# Bloquear acesso a arquivos de backup
<FilesMatch "\.(bak|backup|old|tmp|swp)$">
    Require all denied
</FilesMatch>